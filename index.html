<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">

    <title>Pathfinding AI | Documentation by Michael Skotar</title>

    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/stroke.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/prettyPhoto.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shCore.css" media="all">
    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shThemeRDark.css" media="all">

    <!-- CUSTOM -->
    <link rel="stylesheet" type="text/css" href="css/custom.css">
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>
    <button onclick="topFunction()" id="myBtn" title="Go to top"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>

    <script>
        var mybutton = document.getElementById("myBtn");
        window.onscroll = function() {scrollFunction()};
        function scrollFunction() {
            if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }
        function topFunction() {
            window.scrollTo({ top: 0, behavior: 'smooth' })
            document.documentElement.scrollTo({ top: 0, behavior: 'smooth' })
        }

        document.addEventListener("DOMContentLoaded", () => {
            document.querySelector('#mode').addEventListener('click',()=>{
                document.querySelector('html').classList.toggle('dark');
            })
        });


    </script>

    <!--Python Config-->
    <py-config>
        packages = ["numpy", "matplotlib"]
    </py-config>

    <div id="wrapper">

        <div id="mode" >
            <div class="dark">
                <svg aria-hidden="true" viewBox="0 0 512 512">
                    <title>lightmode</title>
                    <path fill="currentColor" d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"></path>
                </svg>
            </div>
            <div class="light">
                <svg aria-hidden="true" viewBox="0 0 512 512">
                    <title>darkmode</title>
                    <path fill="currentColor" d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"></path>
                </svg>
            </div>
        </div>

        <div class="container">

            <section id="top" class="section docs-heading">

                <div class="row">
                    <div class="col-md-12">
                        <div class="big-title text-center">
                            <h1>Pathfinding AI using Reinforced Learning</h1>
                            <p class="lead">Michael Skotar | <a href="https://github.com/pixlbreaker">pixlbreaker</a></p>
                        </div>
                        <!-- end title -->
                    </div>
                    <!-- end 12 -->
                </div>
                <!-- end row -->

                <hr>

            </section>
            <!-- end section -->

            <div class="row">

                <div class="col-md-3">
                    <nav class="docs-sidebar" data-spy="affix" data-offset-top="300" data-offset-bottom="200" role="navigation">
                        <ul class="nav">
                            <li><a href="#line1">Project Objective</a></li>
                            <li><a href="#line2">How to Use</a></li>
                            <li><a href="#line3">Reinforced Learning</a></li>
                            <li><a href="#line4">Pathfinding</a></li>
                            <li><a href="#line5">Methods and Functions</a>
                                <ul class="nav">
                                    <li><a href="#line5_1">Board Class</a></li>
                                    <li><a href="#line5_2">Model Class</a></li>
                                    <li><a href="#line5_3">Main Class</a></li>
                                </ul>
                            </li>
                            <li><a href="#line6">Code Samples</a></li>
                            <li><a href="#line7">Output</a>
                                <ul class="nav">
                                    <li><a href="#line7_1">General Information</a></li>
                                    <li><a href="#line7_2">Graphs</a></li>
                                </ul>
                            </li>
                            <li><a href="#line8">Image Example</a></li>
                            <li><a href="#line11">Copyright and license</a></li>
                        </ul>
                    </nav >
                </div>
                <div class="col-md-9">
                    <section class="welcome">

                        <div class="row">
                            <div class="col-md-12 left-align">
                               <h2 class="dark-text">Introduction<hr></h2>
                                <div class="row">

                                    <div class="col-md-12 full">
                                        <div class="intro1">
                                            <ul>
                                                <li><strong>Project Name : </strong>Pathfinding AI</li>
                                                <li><strong>Author  : </strong> <a href="https://github.com/pixlbreaker" target="_blank">Michael Skotar</a></li>
                                                <li><strong>License : </strong> <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a></li>
                                            </ul>
                                        </div>

                                        <hr>
                                        <div>
                                            <p>This is a project uses Machine Learning techniques to solve a pathfiding problem and present the best path to the user. This project was done for fun to demonstrate several machine learning techniques from scratch.
                                            </p>

                                            <p>This documentation is to help userstand the machine learning techniques and mathematics used throughout the project. Please go through the documentation carefully to understand how it was made. Python, Linear Algebra and Numpy knowledge is required to edit this project.</p>

                                            <div class="intro2 clearfix">
                                                <p><i class="fa fa-exclamation-triangle"></i> This is a non-production project. It is just for fun and demo use. No support is provided.
                                                </p>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                                <!-- end row -->
                            </div>
                        </div>
                    </section>

                    <section id="line1" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Project Objective<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-12">
                                <p>Here we want to given any puzzle solve it using reinfoced machine learning. The model will find the best path from the start to the end point on in the puzzle. 
                                    It will do this by running the simulation multiple times in order to get the optimal path and displays this to the user.</p>

                                <h4>Inspiration</h4>
                                <p>The inspiration for this project came from similar projects that would teach an AI to play a game or solve a puzzle. Here is an example of one of those: </p>
                                <div class="media">
                                    <iframe width="560" height="315" src="https://www.youtube.com/embed/L4KBBAwF_bE" frameborder="0" allowfullscreen></iframe>
                                </div>
                                <p> In this case we see that Mario is controlled by the program, and the model uses reinfocement in order to teach mario how to get to the end of the level successfully.</p>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->

                    <section id="line2" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">How to Use<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="intro2 clearfix">
                            <p><i class="fa fa-code"></i> This project uses python and numpy to create the model. To read more about python. <a href="https://www.python.org/">Python Documentation</a> </p>
                        </div>
                        <p>Python information. For this project we use python verion: <b>3.8</b></p>
                        <hr>

                        <h4>Dependancies</h4>
                        
                        <p>In this specific case the project uses the following projects:</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h4><a href="https://numpy.org/" class="btn btn-primary">Numpy</a></h4>
                                <p>Numpy is a popular library for Python that adds support for mathematical functions and operations such as: multi-dimnetional matricies. This is important for the operations that are performed throughout the project.</p>
                            </div>
                            <div class="col-md-6">
                                <h4><a href="https://matplotlib.org/" class="btn btn-primary">Matplotlib</a></h4>
                                <p>Matplotlib is a plotting library for Python that adds the ability to add interactive, animated, and static visuals for mathematical expressions.</p>
                            </div>
                        </div>

                        
                        <hr>
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <div class="media">
                                    <iframe width="560" height="315" src="https://www.youtube.com/embed/b56ufhZbdRY" frameborder="0" allowfullscreen></iframe>
                                </div>
                            </div>
                        </div>
                        
                        <h4>How to Run</h4>
                        
                        <p>The project contains a main file which can run the project, generate a board and have the program solve it and display it.
                            <br> Another way to run the file would be to use the Jupyter notebook provided and run the file that way. This method lets the user finer control over the functions that are being run, 
                            and gives a greater understanding to the work involved.
                        </p>
                        <hr>

                    </section>
                    <!-- end section -->

                    <section id="line3" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Reinforced Learning<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <h4>What is Machine Learning?</h4>

                        <p>Machine learning (ML) is a field of inquiry devoted to understanding and building methods that 'learn', that is, methods that leverage data to improve performance on some set of tasks. It is seen as a part of artificial intelligence. Machine learning algorithms build a model based on sample data, known as training data, in order to make predictions or decisions without being explicitly programmed to do so.</p>

                        <a href="https://www.ibm.com/cloud/learn/machine-learning" class="btn btn-primary">IBM Machine Learning Article</a>
                        <hr>

                        <h4>What is Reinforced Learning?</h4>

                        <p>Reinforcement learning (RL) is an area of machine learning concerned with how intelligent agents ought to take actions in an environment in order to maximize the notion of cumulative reward. Reinforcement learning is one of three basic machine learning paradigms, alongside supervised learning and unsupervised learning.</p>

                        <a href="https://deepsense.ai/what-is-reinforcement-learning-the-complete-guide/" class="btn btn-primary">Deep Sense AI article</a>
                        <hr>
                        <h4>Machine Learning Youtube Videos</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="media">
                                    <iframe width="560" height="315" src="https://www.youtube.com/embed/HcqpanDadyQ" frameborder="0" allowfullscreen></iframe>
                                </div>

                            </div>
                            <div class="col-md-6">
                                <div class="media">
                                    <iframe width="560" height="315" src="https://www.youtube.com/embed/JgvyzIkgxF0" frameborder="0" allowfullscreen></iframe>
                                </div>

                            </div>
                        </div>

                    </section>
                    <!-- end section -->

                    <section id="line4" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Pathfinding<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <h4>What is Pathfinding?</h4>
                            <p>Pathfinding is a technique used in artificial intelligence to find the shortest or most efficient path between two points. It is often used in video games and other interactive applications to move characters or objects from one location to another in a virtual environment.</p>
                            <p>There are many different algorithms and techniques that can be used for pathfinding, including breadth-first search, depth-first search, A* search, and Dijkstra's algorithm. These algorithms work by exploring the available options and determining the optimal path based on various factors such as distance, cost, and obstacles.</p>
                            <p>One common use of pathfinding is in real-time strategy games, where units must navigate around obstacles and enemies to reach their destination. It is also used in robotics to help robots navigate around physical obstacles in the real world.</p>
                            <p>Overall, pathfinding is an important part of artificial intelligence and is used in a wide range of applications to help agents move efficiently and effectively through complex environments.</p>
                            
                            <h4>Pathfinding with Reinforced Learning</h4>
                            <div class="col-md-12">
                                <p>In the context of pathfinding, reinforcement learning can be used to train an agent to find the optimal path between two points in a given environment. This is done by providing the agent with a reward signal for reaching its destination and possibly also penalizing it for taking longer or more costly paths. The agent can then learn through trial and error which actions lead to the highest reward and adjust its behavior accordingly.</p>
                            </div>
                        </div>
                        <div class="row">
                            <h4>Pathfinding with Reinforced Learning</h4>
                            <div class="col-md-8 col-md-offset-2">
                                <div class="media">
                                    <iframe width="1280" height="720" src="https://www.youtube.com/embed/8gqtUsSnnjg" title="Deep reinforcement learning based multi agent pathfinding" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>

                                <p>Here is an example of a pathfinding deep learning 3d example</p>
                            </div>
                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->

                    <section id="line5" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Methods and Functions<hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">

                            <div class="col-md-12">
                                <h3 id="line5_1">Board Class</h3>
                                <p>This is a implementation of a board class for a pathfinding task. The board is represented as a 2D numpy array with shape (length, width). The board is initialized with some random obstacles (represented by 1s) and two special points: an starting location for the agent (represented by 2) and an end goal (represented by 3).

                                    The class has several methods for manipulating the board state:</p>
                            </div>

                            <div class="col-md-10">
                                <a href="images/grid_2d.png" data-rel="prettyPhoto"><img src="images/grid_2d.png" alt="" class="img-responsive img-thumbnail"></a>
                                <h4>Class Methods</h4>
                                <ul>
                                    <li><code>print_enviorment()</code> - displays a visual representation of the board using matplotlib.</li>
                                    <li><code>current_state()</code> - returns the current location of the agent as a tuple.</li>
                                    <li><code>reset_board()</code> - resets the board back to its original state with the agent at the starting location.</li>
                                    <li><code>Trans(L, a)</code> - translates the agent in a given direction a from its current location L. The function returns a tuple containing the new location of the agent and a reward, which is 0 unless the agent reaches the end goal, in which case it returns 25.</li>
                                </ul>
                            </div>
                            <!-- end col -->

                            
                        </div>

                        <div class="row">

                            <div class="col-md-12">
                                <h3 id="line5_2">Model Class</h3>
                                <p>This code implements a reinforcement learning algorithm for pathfinding on a grid-based environment. The grid environment is represented by the "board" object, which is an input to the Model class.

                                    The Model class has several methods for performing the reinforcement learning:</p>
                            </div>

                            <div class="col-md-10">
                                <a href="images/model.jpg" data-rel="prettyPhoto"><img src="images/model.jpg" alt="" class="img-responsive img-thumbnail"></a>
                                <h4>Class Methods</h4>
                                <ul>
                                    <li><code>choose()</code> - Given the current location of the agent (L) and a temperature parameter (beta), it selects an action to take. The action is selected using a softmax distribution over the Q-values of the available actions at the current location, where the Q-values are given by the Q-matrix.</li>
                                    <li><code>updateQ()</code> - Given the current location (L), the action taken (a), the learning rate (alpha), and the discount factor (gamma), it updates the Q-value of the state-action pair (L, a) using the reward received and the maximum Q-value of the next state.</li>
                                    <li><code>episode()</code> - Given the initial location (L), the learning rate (alpha), the discount factor (gamma), and the temperature parameter (beta), it performs an episode of reinforcement learning by repeatedly selecting actions using the choose method, updating the Q-values using the updateQ method, and observing rewards until the episode terminates.</li>
                                    <li><code>learn()</code> - Given the number of episodes (N), the initial location (L), the learning rate (alpha), the discount factor (gamma), and the temperature parameter (beta), it performs N episodes of reinforcement learning and returns a list of episode lengths.</li>
                                    <li><code>plot_episode()</code> - It plots the episode lengths returned by the learn method.</li>
                                    <li><code>plot_heatmap()</code> - It prints a heatmap of the Q-matrix, where each cell represents the average Q-value of the state-action pairs corresponding to that cell.</li>
                                </ul>
                            </div>
                            <!-- end col -->

                            
                        </div>

                        <div class="row">

                            <div class="col-md-12">
                                <h3 id="line5_3">Main Class</h3>
                                <p>The first line imports the NumPy library and gives it the alias "np". NumPy is a popular library for scientific computing in Python and provides support for arrays, linear algebra, and other mathematical operations. The remaining lines of code create a game board, use a machine learning model to learn how to navigate the board, and then display the results using matplotlib.</p>
                            </div>

                            <div class="col-md-10">
                                <a href="images/main.jpg" data-rel="prettyPhoto"><img src="images/main.jpg" alt="" class="img-responsive img-thumbnail"></a>
                                <h4>Class Methods</h4>
                                <p>The import numpy as np statement imports the NumPy library and gives it an alias np, which is a common shorthand. NumPy is a popular numerical computing library for Python, which provides support for multi-dimensional arrays and matrices, as well as a wide variety of mathematical functions for manipulating these arrays.
                                    <br>
                                    The import matplotlib.pyplot as plt statement imports the pyplot module from the matplotlib library and gives it an alias plt. pyplot is a collection of functions in matplotlib that provide a convenient interface for creating and customizing charts and plots.
                                    <br>
                                    The import Board as board statement imports a custom module called Board and gives it an alias board. The Board module presumably contains a class or functions for generating and manipulating a game board.
                                    <br>
                                    The import Model statement imports a custom module called Model, which presumably contains a class or functions for training and using a reinforcement learning model.
                                    <br>
                                    The code then generates a game board using the Board class, prints the array representation of the board, and plots a heatmap of the board. It then creates a Model object based on the game board, trains the model for a certain number of episodes using the learn method, and prints the results.
                                    <br>
                                    Finally, the code calls several methods of the Model object to print the episodes, plot the heatmap, find the best path according to the model, and print the best path.</p>
                            </div>
                            <!-- end col -->

                            
                        </div>

                    </section>
                    <!-- end section -->

                    <section id="line6" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Code Samples <hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">

                            <div class="col-md-12">
                                <p>This is a snippet of some of the python code. To see the whole project check out my github. Which is linked at the top.</p>
                            </div>

                            <div class="col-md-12">
                                <h4>Model Class</h4>
                                <pre class="brush: html">
                                    import numpy as np
                                    import matplotlib.pyplot as plt
                                    import matplotlib.animation as animation

                                    class Model:
                                        '''The Reinforcement Model that is trained to "solve" the given board.'''

                                        def __init__(self, board):
                                            self.path_list = []
                                            self.episode_list = []
                                            self.board = board
                                            # Gets the shape of the board
                                            d = board.shape

                                            # Creates Q
                                            self.Q = np.zeros((d[0], d[1], 4))
                                        
                                        def choose(self, L, beta):
                                            '''Chooses a random action with the current location L and a beta'''
                                            # Numerator and Denominator
                                            numerator = np.e **(beta * self.Q[L])
                                            denominator = np.sum(np.e **(beta * self.Q[L]))
                                            
                                            # List of actions up, down, left, right
                                            actions_list = np.array([0,1,2,3])
                                            Qvalues = numerator/denominator
                                            
                                            # Uses np.random.choice to choose a random action
                                            return np.random.choice(actions_list, p=Qvalues)
                                </pre>
                            </div>

                            <div class="col-md-12">
                                <h4>Board Class</h4>
                                <pre class="brush: html">
                                    from typing import Tuple
                                    import numpy as np
                                    import matplotlib.pyplot as plt

                                    class Board():
                                        '''A board that holds an nxn location that will be solved by the pathfinding model.'''

                                        def __init__(self, length = 10, width=10, n=10) -> None:
                                            array = np.zeros((length, width))

                                            for i in range(n):
                                                array[np.random.randint(0, length), np.random.randint(0, width)] = 1

                                            array[np.random.randint(0, length), np.random.randint(0, width)] = 2
                                            array[np.random.randint(0, length), np.random.randint(0, width)] = 3
                                            self.board = array
                                            self.shape = array.shape
                                            self.starting_location = self.current_state()

                                        def __print__(self):
                                            '''Prints the board in a 2-D array'''
                                            return self.board

                                        def print_enviorment(self):
                                            '''Prints the board and shows it's current state'''

                                            # Prints with the 
                                            plt.imshow(self.board, cmap='viridis', interpolation='nearest')
                                            plt.title("Board")
                                            plt.show()
                                </pre>
                            </div>
                            
                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->

                    <section id="line7" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Code Testing and Output<hr></h2>
                                <p>Here is an example of some code executed and what it would look like. The actual code has been loaded into the webpage and to run it you can run the following example:</p>
                                <py-script>
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.animation as animation
from typing import Tuple


class Model:
    '''The Reinforcement Model that is trained to "solve" the given board.'''

    def __init__(self, board):
        self.path_list = []
        self.episode_list = []
        self.board = board
        # Gets the shape of the board
        d = board.shape

        # Creates Q
        self.Q = np.zeros((d[0], d[1], 4))
    
    def choose(self, L, beta):
        '''Chooses a random action with the current location L and a beta'''
        # Numerator and Denominator
        numerator = np.e **(beta * self.Q[L])
        denominator = np.sum(np.e **(beta * self.Q[L]))
        
        # List of actions up, down, left, right
        actions_list = np.array([0,1,2,3])
        Qvalues = numerator/denominator
        
        # Uses np.random.choice to choose a random action
        return np.random.choice(actions_list, p=Qvalues)
    
    # Update Q
    def updateQ(self, L, a, alpha, gamma):
        reward = self.board.Trans(L, a)[1]
        next_state = self.board.current_state()
        
        # Updates the Q function
        self.Q[L][a] = self.Q[L][a] + alpha * (reward + (gamma * np.max(self.Q[next_state])) -  self.Q[L][a])

        # print(Q[L][a])
        # returns the reward
        return reward

    # Episode
    def episode(self, L, alpha, gamma, beta):
        lst = []
        reward = 0
        count = 0
        # Keeps going until we reach the reward
        while reward != 25:
            a = self.choose(L, beta)

            # updates q
            reward = self.updateQ(L, a, alpha, gamma)
            L = self.board.current_state()
            count += 1
            lst.append(a)

        self.path_list.append(lst)
        return count

    # Learn function
    def learn(self, N, L, alpha, gamma, beta):
        
        # # Gets the shape of the board
        # d = board.shape

        # # Creates Q
        # Q = np.zeros((d[0], d[1], 4))

        episode_lst = []
        # Runs episode N times
        for i in range(N):

            # Runs the episode and gets the episode count
            count = self.episode(L, alpha, gamma, beta)

            # Resets the code
            self.board.reset_board()
            episode_lst.append(count)
        
        self.episode_list = episode_lst
        return episode_lst
    
    # Plots the episodes
    def plot_episodes(self):

        length = len(self.episode_list)
        plt.plot(np.arange(0, length), self.episode_list)
        plt.xlabel('Episode')
        plt.ylabel('Episode Length')
        plt.title('One run of Q Learning')
        plt.grid()
        plt.show()

    # Returns the Best path from the Path List
    def best_path(self):
        '''Returns the best path of the path list'''

        return self.path_list[-1]

    def print_best_path(self):
        '''Prints the best path on the board'''
        path = self.best_path()

        # Reset the board
        self.board.reset_board()

        # The Starting Position
        start = self.board.current_state()
        y = start[0]
        x = start[1]

        # Iterate through it
        for move in path[:-1]:

            # Given the action -> up
            if(move == 0):
                new_y = y - 1
                self.board.board[new_y, x] = 4
                y = new_y

            # Given the action -> down
            elif(move == 1):
                new_y = y + 1
                self.board.board[new_y, x] = 4
                y = new_y
            
            # Given the action -> left
            elif(move == 2):
                new_x = x - 1
                self.board.board[y, new_x] = 4
                x = new_x

            # Given the action -> right
            elif(move == 3):
                new_x = x + 1
                self.board.board[y, new_x] = 4
                x = new_x
            

            
        # Prints the board
        self.board.print_enviorment()
        print(self.board.board)



    # Prints the Heatmap
    def print_heatmap(self):
        Q_max = np.average(self.Q, axis=2)
        plt.imshow(Q_max, cmap='hot', interpolation='nearest')
        plt.title("Board")
        plt.show()

    


        
class Board():
    '''A board that holds an nxn location that will be solved by the pathfinding model.'''

    def __init__(self, length = 10, width=10, n=10) -> None:
        array = np.zeros((length, width))

        for i in range(n):
            array[np.random.randint(0, length), np.random.randint(0, width)] = 1

        array[np.random.randint(0, length), np.random.randint(0, width)] = 2
        array[np.random.randint(0, length), np.random.randint(0, width)] = 3
        self.board = array
        self.shape = array.shape
        self.starting_location = self.current_state()

    def __print__(self):
        '''Prints the board in a 2-D array'''
        return self.board

    def print_enviorment(self):
        '''Prints the board and shows it's current state'''

        # Prints with the 
        plt.imshow(self.board, cmap='viridis', interpolation='nearest')
        plt.title("Board")
        plt.show()
    
    def current_state(self) -> Tuple:
        '''Gets the current state of where the agent is on the board and returns it as a tuple.'''

        # Finds the x and y of the agent
        agent = np.where(self.board == 2)
        agent_x, agent_y = agent[0][0], agent[1][0]

        return agent_x, agent_y
    
    def reset_board(self):
        '''Resets the board back to its original position.'''
        self.board[self.current_state()[0], self.current_state()[1]] = 3
        self.board[self.starting_location[0], self.starting_location[1]] = 2
    
    def Trans(self, L, a):
        '''Translates the agent in with the given action a. The location L, is where the agent is currently.'''
        # X and Y location of the agent
        y = L[0]
        x = L[1]

        # length of board
        y_len = self.board.shape[1]
        x_len = self.board.shape[0]

        # End point
        end_pt = np.where(self.board == 3)
        
        # Given the action -> up
        if a==0:
            new_y = y - 1
            if new_y >= 0 and self.board[new_y, x] != 1:
                self.board[y, x] = 0
                self.board[new_y, x] = 2

        # Given the action -> down
        elif a==1:
            new_y = y + 1
            if new_y < y_len and self.board[new_y, x] != 1:
                self.board[y, x] = 0
                self.board[new_y, x] = 2
        
        # Given the action -> left
        elif a==2:
            new_x = x - 1
            if new_x >= 0 and self.board[y, new_x] != 1:
                self.board[y, x] = 0
                self.board[y, new_x] = 2
        
        # Given the action -> right
        elif a==3:
            new_x = x + 1
            if new_x  < x_len and self.board[y, new_x] != 1:
                self.board[y, x] = 0
                self.board[y, new_x] = 2

        
        curr_pt = np.where(self.board == 2)
        curr_x = curr_pt[1][0]
        curr_y = curr_pt[0][0]

        # determines the reward
        if (np.array_equal(end_pt, curr_pt)):
            return ((curr_x, curr_y), 25)
        return ((curr_x, curr_y), 0)


                                </py-script>

                                <py-repl>
# Generates the board
b = Board(5, 5, 5)
print("This is the board: \n 0: Empty space, 1: Wall, 2: Start, 3: End")
print(b.board)

# Creates the model for the current board
model = Model(b)
model.learn(50, model.board.current_state(), 1, 0.9, 1)

# Prints the episodes and the heatmap
model.best_path()
print("This is the solved board: \n 0: Empty space, 1: Wall, 2: Start, 3: End, 4: Path taken")
model.print_best_path()
                                </py-repl>
                                <py-terminal></py-terminal>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-4">
                                <a href="images/model.jpg" data-rel="prettyPhoto"><img src="images/model.jpg" alt="" class="img-responsive img-thumbnail"></a>
                            </div>

                            <div class="col-md-8">
                                <h4 id="line7_1">General Information - </h4>
                                <p>This is a small example of running the Pathfinding AI. Here we create a board of size 5 x 5, with 5 barriers. Afterwards we train the model, the result being a solved board</p>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <hr>

                        <div class="row">
                            <div class="col-md-4">
                                <a href="images/board.png" data-rel="prettyPhoto"><img src="images/board.png" alt="" class="img-responsive img-thumbnail"></a>
                            </div>

                            <div class="col-md-8">
                                <h4 id="line7_2">Graphs - </h4>
                                <p>You can display both the solved and unsolved boards as graphs</p>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <hr>

                        

                    </section>
                    <!-- end section -->

                    <section id="line8" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Images Example <hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-6">
                                <p>Here these are examples of it running with images before:</p>
                                <hr>
                                <strong>Before:</strong>
                                <a href="images/board.png" data-rel="prettyPhoto"><img src="images/board.png" alt="" class="img-responsive img-thumbnail"></a>

                                
                            </div>

                            <div class="col-md-6">
                                <p>Here these are examples of it running with images after:</p>
                                <hr>
                                <strong>After:</strong>
                                <a href="images/solved_board.png" data-rel="prettyPhoto"><img src="images/solved_board.png" alt="" class="img-responsive img-thumbnail"></a>
                            </div>
                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->

                    <section id="line11" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Copyright and license <hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-12">
                                
                                <p>Code released under the <a href="#" target="_blank">Un License</a> License.</p>                        
                                <p>For more information about copyright and license check <a href=" https://choosealicense.com/licenses/unlicense/" target="_blank">choosealicense.com</a>.</p>
                            
                            </div>
                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->
                </div>
                <!-- // end .col -->

            </div>
            <!-- // end .row -->

        </div>
        <!-- // end container -->

    </div>
    <!-- end wrapper -->

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/retina.js"></script>
    <script src="js/jquery.fitvids.js"></script>
    <script src="js/wow.js"></script>
    <script src="js/jquery.prettyPhoto.js"></script>

    <!-- CUSTOM PLUGINS -->
    <script src="js/custom.js"></script>
    <script src="js/main.js"></script>

    <script src="js/syntax-highlighter/scripts/shCore.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushXml.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushCss.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushJScript.js"></script>

</body>

</html>
